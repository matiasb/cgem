{% extends 'base.html' %}
{% load qurl %}
{% load static %}

{% block navbar-title %}
    <a class="navbar-brand" href="{% url 'entries' book.slug %}">{{ book }}</a>
{% endblock navbar-title %}

{% block content %}

<div class="row">
  <div class="col-md-12">
    {% for tag in used_tags %}
    <div class="btn-group">
        <a class="btn btn-xs btn-info close" href="{% qurl request.get_full_path tag-=tag %}">{{ tag }} &times;</a>
    </div>
    {% endfor %}
    {% if year %}
    <div class="btn-group">
        <a class="btn btn-xs btn-info close" href="{% qurl request.get_full_path year-=year %}">{{ year }} &times;</a>
    </div>
    {% endif %}
    {% if month %}
    <div class="btn-group">
        <a class="btn btn-xs btn-info close" href="{% qurl request.get_full_path month-=month %}">{{ month }} &times;</a>
    </div>
    {% endif %}
    {% if who %}
    <div class="btn-group">
        <a class="btn btn-xs btn-info close" href="{% qurl request.get_full_path who-=who %}">{{ who }} &times;</a>
    </div>
    {% endif %}
  </div>
</div>

<div class="row">

<div class="col-md-4">
    {% include 'gemcore/_show_tags.html' %}
    <div class="btn-group">
        <a href="{% url 'add-entry' book.slug %}" class="btn btn-primary">
            Add entry</a>
        <a href="{% url 'load-from-file' book.slug %}" class="btn btn-default">
            Load from file</a>
    </div>
</div>

<div class="col-md-8">
    {% if entries %}
    <table class="table table-condensed table-hover table-striped">
        <thead>
            <tr>
                <th>When</th>
                <th>Who</th>
                <th>What</th>
                <th>Amount</th>
                <th>Account</th>
                <th>Tags</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for entry in entries %}
            <tr onclick="window.document.location='{% url 'entry' book.slug entry.id %}'">
                <td>{{ entry.when|date:"d/m/Y" }}</td>
                <td>{{ entry.who }}</td>
                <td>{{ entry.what }}</td>
                <td class="text-right {% if not entry.is_income %}expense{% endif %}">
                    {% if entry.is_income %}+{% else %}-{% endif %} {{ entry.amount }}
                </td>
                <td class="{% if not entry.is_income %}expense{% endif %}">
                    {{ entry.account }}</td>
                <td>{% for n in entry.tags.names %}{{ n }}<br/>{% endfor %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No entries in the system.</dp>
    {% endif %}
</div>

</div>

{% endblock content %}
